<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.15.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ToyLisp: Arena Allocator</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">ToyLisp<span id="projectnumber">&#160;0.2.0</span>
   </div>
   <div id="projectbrief">A simple lisp interpreter</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.15.0 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search/",'.html');
</script>
<script type="text/javascript">
$(function() { codefold.init(); });
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(function(){initNavTree('group__arena.html','',''); });
</script>
<div id="container">
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="headertitle"><div class="title">Arena Allocator </div></div>
</div><!--header-->
<div class="contents">

<p>Fast region-based memory allocation with automatic growth.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-nested-classes" class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:Arena" id="r_Arena"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structArena.html">Arena</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Represents a memory arena for fast allocation and bulk deallocation.  <a href="structArena.html#details">More...</a><br /></td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-define-members" class="groupheader"><a id="define-members" name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:gab4f6f82fd3600f31ee1807840e1ec5b3" id="r_gab4f6f82fd3600f31ee1807840e1ec5b3"><td class="memItemLeft" align="right" valign="top"><a id="gab4f6f82fd3600f31ee1807840e1ec5b3" name="gab4f6f82fd3600f31ee1807840e1ec5b3"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>GROWTH_FACTOR</b>&#160;&#160;&#160;2</td></tr>
<tr class="memdesc:gab4f6f82fd3600f31ee1807840e1ec5b3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Factor by which the arena grows when it runs out of space. <br /></td></tr>
<tr class="memitem:gaba979d386607d556208cc0e905db89d3" id="r_gaba979d386607d556208cc0e905db89d3"><td class="memItemLeft" align="right" valign="top"><a id="gaba979d386607d556208cc0e905db89d3" name="gaba979d386607d556208cc0e905db89d3"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>DEFAULT_ARENA_CAPACITY</b>&#160;&#160;&#160;1024</td></tr>
<tr class="memdesc:gaba979d386607d556208cc0e905db89d3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Default initial capacity if 0 is passed to <a class="el" href="#ga4e867a0e03259da5851987e845cb9972" title="Initializes an arena with a specified initial capacity.">arena_init()</a>. <br /></td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-func-members" class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ga4e867a0e03259da5851987e845cb9972" id="r_ga4e867a0e03259da5851987e845cb9972"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structArena.html">Arena</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga4e867a0e03259da5851987e845cb9972">arena_init</a> (size_t initial_capacity)</td></tr>
<tr class="memdesc:ga4e867a0e03259da5851987e845cb9972"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initializes an arena with a specified initial capacity.  <br /></td></tr>
<tr class="memitem:ga494c8cea4f0fa116e2559b9dfc080600" id="r_ga494c8cea4f0fa116e2559b9dfc080600"><td class="memItemLeft" align="right" valign="top">void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga494c8cea4f0fa116e2559b9dfc080600">arena_alloc</a> (<a class="el" href="structArena.html">Arena</a> **arena_ptr, size_t size)</td></tr>
<tr class="memdesc:ga494c8cea4f0fa116e2559b9dfc080600"><td class="mdescLeft">&#160;</td><td class="mdescRight">Allocates a block of memory from the arena.  <br /></td></tr>
<tr class="memitem:gac48c0591afbd71c1fd3ac2c6875c9999" id="r_gac48c0591afbd71c1fd3ac2c6875c9999"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#gac48c0591afbd71c1fd3ac2c6875c9999">arena_reset</a> (<a class="el" href="structArena.html">Arena</a> *arena)</td></tr>
<tr class="memdesc:gac48c0591afbd71c1fd3ac2c6875c9999"><td class="mdescLeft">&#160;</td><td class="mdescRight">Resets the arena, making all its memory available for reuse.  <br /></td></tr>
<tr class="memitem:ga2028290a2a15c13bf821b0c1e22bc1d4" id="r_ga2028290a2a15c13bf821b0c1e22bc1d4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga2028290a2a15c13bf821b0c1e22bc1d4">arena_destroy</a> (<a class="el" href="structArena.html">Arena</a> *arena)</td></tr>
<tr class="memdesc:ga2028290a2a15c13bf821b0c1e22bc1d4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Destroys the arena and frees all its memory.  <br /></td></tr>
<tr class="memitem:ga80e56a0ed80fb9e01b0fb7604f5687f9" id="r_ga80e56a0ed80fb9e01b0fb7604f5687f9"><td class="memItemLeft" align="right" valign="top">char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga80e56a0ed80fb9e01b0fb7604f5687f9">arena_strdup</a> (<a class="el" href="structArena.html">Arena</a> **arena_ptr, const char *s)</td></tr>
<tr class="memdesc:ga80e56a0ed80fb9e01b0fb7604f5687f9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Duplicates a string into the arena.  <br /></td></tr>
<tr class="memitem:gaac7cdbd76fd9b528470346b3363052fb" id="r_gaac7cdbd76fd9b528470346b3363052fb"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#gaac7cdbd76fd9b528470346b3363052fb">arena_print_stats</a> (const <a class="el" href="structArena.html">Arena</a> *arena, const char *name)</td></tr>
<tr class="memdesc:gaac7cdbd76fd9b528470346b3363052fb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Prints statistics about the arena's memory usage.  <br /></td></tr>
</table>
<a name="details" id="details"></a><h2 id="header-details" class="groupheader">Detailed Description</h2>
<p>Fast region-based memory allocation with automatic growth. </p>
<p>The arena allocator provides a simple and efficient way to manage memory for objects with similar lifetimes. It allocates from a contiguous buffer and can reset all allocations at once without individual frees.</p>
<p><b>Key features:</b></p><ul>
<li>Amortized O(1) allocation through exponential growth</li>
<li>O(1) bulk deallocation via <span class="tt"><a class="el" href="#gac48c0591afbd71c1fd3ac2c6875c9999" title="Resets the arena, making all its memory available for reuse.">arena_reset()</a></span></li>
<li>Sequential memory layout (cache-friendly)</li>
<li>No per-allocation overhead</li>
<li>No fragmentation</li>
</ul>
<p><b>Typical usage pattern:</b> </p><div class="fragment"><div class="line"><a class="code hl_struct" href="structArena.html">Arena</a>* temp_arena = <a class="code hl_function" href="#ga4e867a0e03259da5851987e845cb9972">arena_init</a>(4096);  <span class="comment">// Start with 4KB</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// Allocate many objects...</span></div>
<div class="line"><span class="keywordtype">char</span>* str = <a class="code hl_function" href="#ga80e56a0ed80fb9e01b0fb7604f5687f9">arena_strdup</a>(&amp;temp_arena, <span class="stringliteral">&quot;hello&quot;</span>);</div>
<div class="line"><span class="keywordtype">int</span>* array = <a class="code hl_function" href="#ga494c8cea4f0fa116e2559b9dfc080600">arena_alloc</a>(&amp;temp_arena, 100 * <span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Free everything at once</span></div>
<div class="line"><a class="code hl_function" href="#gac48c0591afbd71c1fd3ac2c6875c9999">arena_reset</a>(temp_arena);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Cleanup</span></div>
<div class="line"><a class="code hl_function" href="#ga2028290a2a15c13bf821b0c1e22bc1d4">arena_destroy</a>(temp_arena);</div>
<div class="ttc" id="agroup__arena_html_ga2028290a2a15c13bf821b0c1e22bc1d4"><div class="ttname"><a href="#ga2028290a2a15c13bf821b0c1e22bc1d4">arena_destroy</a></div><div class="ttdeci">void arena_destroy(Arena *arena)</div><div class="ttdoc">Destroys the arena and frees all its memory.</div><div class="ttdef"><b>Definition</b> arena.c:72</div></div>
<div class="ttc" id="agroup__arena_html_ga494c8cea4f0fa116e2559b9dfc080600"><div class="ttname"><a href="#ga494c8cea4f0fa116e2559b9dfc080600">arena_alloc</a></div><div class="ttdeci">void * arena_alloc(Arena **arena_ptr, size_t size)</div><div class="ttdoc">Allocates a block of memory from the arena.</div><div class="ttdef"><b>Definition</b> arena.c:31</div></div>
<div class="ttc" id="agroup__arena_html_ga4e867a0e03259da5851987e845cb9972"><div class="ttname"><a href="#ga4e867a0e03259da5851987e845cb9972">arena_init</a></div><div class="ttdeci">Arena * arena_init(size_t initial_capacity)</div><div class="ttdoc">Initializes an arena with a specified initial capacity.</div><div class="ttdef"><b>Definition</b> arena.c:13</div></div>
<div class="ttc" id="agroup__arena_html_ga80e56a0ed80fb9e01b0fb7604f5687f9"><div class="ttname"><a href="#ga80e56a0ed80fb9e01b0fb7604f5687f9">arena_strdup</a></div><div class="ttdeci">char * arena_strdup(Arena **arena_ptr, const char *s)</div><div class="ttdoc">Duplicates a string into the arena.</div><div class="ttdef"><b>Definition</b> arena.c:76</div></div>
<div class="ttc" id="agroup__arena_html_gac48c0591afbd71c1fd3ac2c6875c9999"><div class="ttname"><a href="#gac48c0591afbd71c1fd3ac2c6875c9999">arena_reset</a></div><div class="ttdeci">void arena_reset(Arena *arena)</div><div class="ttdoc">Resets the arena, making all its memory available for reuse.</div><div class="ttdef"><b>Definition</b> arena.c:68</div></div>
<div class="ttc" id="astructArena_html"><div class="ttname"><a href="structArena.html">Arena</a></div><div class="ttdoc">Represents a memory arena for fast allocation and bulk deallocation.</div><div class="ttdef"><b>Definition</b> arena.h:74</div></div>
</div><!-- fragment --><dl class="section warning"><dt>Warning</dt><dd>After <span class="tt"><a class="el" href="#gac48c0591afbd71c1fd3ac2c6875c9999" title="Resets the arena, making all its memory available for reuse.">arena_reset()</a></span>, all pointers previously returned by <span class="tt"><a class="el" href="#ga494c8cea4f0fa116e2559b9dfc080600" title="Allocates a block of memory from the arena.">arena_alloc()</a></span> become invalid. Do not use them!</dd>
<dd>
After <span class="tt"><a class="el" href="#ga2028290a2a15c13bf821b0c1e22bc1d4" title="Destroys the arena and frees all its memory.">arena_destroy()</a></span>, the arena pointer itself is invalidated.</dd>
<dd>
Since the arena uses realloc for growth, you must pass the arena by pointer-to-pointer to <span class="tt"><a class="el" href="#ga494c8cea4f0fa116e2559b9dfc080600" title="Allocates a block of memory from the arena.">arena_alloc()</a></span> and <span class="tt"><a class="el" href="#ga80e56a0ed80fb9e01b0fb7604f5687f9" title="Duplicates a string into the arena.">arena_strdup()</a></span>, as the arena's address may change during reallocation. </dd></dl>
<a name="doc-func-members" id="doc-func-members"></a><h2 id="header-doc-func-members" class="groupheader">Function Documentation</h2>
<a id="ga494c8cea4f0fa116e2559b9dfc080600" name="ga494c8cea4f0fa116e2559b9dfc080600"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga494c8cea4f0fa116e2559b9dfc080600">&#9670;&#160;</a></span>arena_alloc()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void * arena_alloc </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structArena.html">Arena</a> **</td>          <td class="paramname"><span class="paramname"><em>arena_ptr</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>size</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Allocates a block of memory from the arena. </p>
<p>Returns a pointer to a memory block of at least <span class="tt">size</span> bytes. The returned pointer is aligned to 8 bytes. If the arena doesn't have enough space, it automatically grows by GROWTH_FACTOR (doubling its size).</p>
<p>The growth strategy ensures amortized O(1) allocation time:</p><ul>
<li>Starting with capacity C, after n doublings we have capacity C*2^n</li>
<li>Total bytes allocated across all reallocations: C + 2C + 4C + ... + C*2^n = C*(2^(n+1) - 1)</li>
<li>This is O(final_capacity), so the amortized cost per byte is O(1)</li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">arena_ptr</td><td>Pointer to the arena pointer. The arena pointer may be updated if reallocation occurs. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">size</td><td>Number of bytes to allocate. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Pointer to the allocated memory (8-byte aligned) within the arena's buffer.</dd></dl>
<dl class="section warning"><dt>Warning</dt><dd>You must pass the address of your arena pointer (<span class="tt">&amp;<a class="el" href="group__arena.html" title="Fast region-based memory allocation with automatic growth.">Arena Allocator</a></span>), not the pointer itself, because realloc may move the arena in memory.</dd>
<dd>
The returned pointer becomes invalid after <span class="tt"><a class="el" href="#gac48c0591afbd71c1fd3ac2c6875c9999" title="Resets the arena, making all its memory available for reuse.">arena_reset()</a></span> or <span class="tt"><a class="el" href="#ga2028290a2a15c13bf821b0c1e22bc1d4" title="Destroys the arena and frees all its memory.">arena_destroy()</a></span> is called on the arena.</dd>
<dd>
Exits the program if reallocation fails. </dd></dl>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__arena_ga494c8cea4f0fa116e2559b9dfc080600_icgraph.png" border="0" usemap="#agroup__arena_ga494c8cea4f0fa116e2559b9dfc080600_icgraph" loading="lazy" alt=""/></div>
<map name="agroup__arena_ga494c8cea4f0fa116e2559b9dfc080600_icgraph" id="agroup__arena_ga494c8cea4f0fa116e2559b9dfc080600_icgraph">
<area shape="rect" title="Allocates a block of memory from the arena." alt="" coords="834,220,921,247"/>
<area shape="rect" href="group__arena.html#ga80e56a0ed80fb9e01b0fb7604f5687f9" title="Duplicates a string into the arena." alt="" coords="676,81,772,108"/>
<area shape="poly" title=" " alt="" coords="852,208,784,141,746,111,747,106,788,137,858,209"/>
<area shape="rect" href="group__value__constructors.html#ga56b1cea30d98236c9dbbecef01b814fe" title="Creates a Value of type TYPE_CLOSURE." alt="" coords="673,195,775,221"/>
<area shape="poly" title=" " alt="" coords="816,224,775,219,775,214,821,224"/>
<area shape="rect" href="group__value__constructors.html#ga172f8b614c16d7f29a55701f9e3f535d" title="Creates and allocates a raw Closure struct pointer." alt="" coords="662,245,786,272"/>
<area shape="poly" title=" " alt="" coords="821,243,787,251,786,246,816,243"/>
<area shape="rect" href="group__value__constructors.html#gabe632b0fee2d6973f5cea25bfd28def0" title="Creates a Value of type TYPE_CONS (a list pair)." alt="" coords="523,157,612,184"/>
<area shape="poly" title=" " alt="" coords="843,211,816,198,785,185,740,175,694,171,613,170,612,165,694,165,741,170,787,180,819,193,848,212"/>
<area shape="rect" href="group__value__constructors.html#ga7e2c2e70f225b9dd96cff95b0166a76b" title="Creates a Value of type TYPE_MACRO." alt="" coords="676,296,772,323"/>
<area shape="poly" title=" " alt="" coords="843,254,787,286,761,298,760,293,785,282,838,255"/>
<area shape="rect" href="group__value__constructors.html#ga0d057406365078f8dcb5cbbc9dc04619" title="Creates and allocates a raw Macro struct pointer." alt="" coords="665,347,783,373"/>
<area shape="poly" title=" " alt="" coords="861,258,829,299,788,337,767,349,765,344,784,333,825,296,856,260"/>
<area shape="rect" href="group__value__constructors.html#ga3f01b34fda4a498bb58353076297f904" title="Creates a Value of type TYPE_ATOM." alt="" coords="523,5,612,32"/>
<area shape="poly" title=" " alt="" coords="678,74,597,35,597,30,683,74"/>
<area shape="rect" href="group__value__constructors.html#ga4bfa92d1baa0a598b48587524e0ab392" title="Creates a Value of type TYPE_ERROR with a formatted message." alt="" coords="524,107,611,133"/>
<area shape="poly" title=" " alt="" coords="658,106,612,116,610,110,663,104"/>
<area shape="rect" href="group__value__constructors.html#ga86414e13068fdebe957e1444cf3bd45e" title="Creates a Value of type TYPE_STRING." alt="" coords="521,56,614,83"/>
<area shape="poly" title=" " alt="" coords="658,85,614,79,614,74,663,84"/>
<area shape="rect" href="group__parser.html#gab44ed7c4f63e2ecefe687b4c38d436a2" title="Parses the string in current_token_buf into a number, string, or atom Value." alt="" coords="371,32,460,59"/>
<area shape="poly" title=" " alt="" coords="505,30,462,40,460,35,510,28"/>
<area shape="rect" href="group__parser.html#ga34b7e5578bd23df76c6c0e8cde2cce56" title="The main recursive parsing function." alt="" coords="177,48,310,91"/>
<area shape="poly" title=" " alt="" coords="505,14,436,14,359,23,320,34,286,50,283,45,319,29,357,17,435,9,510,12"/>
<area shape="poly" title=" " alt="" coords="353,55,312,62,310,58,358,52"/>
<area shape="poly" title=" " alt="" coords="269,33,260,29,243,27,227,29,218,33,214,39,215,48,210,47,209,38,214,29,226,23,243,21,262,24,275,32"/>
<area shape="rect" href="group__parser.html#ga96e89ce14c76411e95f85b3698efbc1c" title="Top&#45;level function to parse a single complete S&#45;expression from the stream." alt="" coords="5,31,129,57"/>
<area shape="poly" title=" " alt="" coords="159,59,130,55,128,50,163,56"/>
<area shape="rect" href="group__parser.html#ga8a7f8b2d75c03f46abf130c218c4262f" title="Parses a list expression from the token stream." alt="" coords="28,81,106,108"/>
<area shape="poly" title=" " alt="" coords="160,92,107,99,105,94,164,88"/>
<area shape="poly" title=" " alt="" coords="119,76,178,68,174,72,122,81"/>
<area shape="rect" href="group__core__evaluator.html#gac92b6c96045b3975a831d3a5a7be4843" title="Evaluates a single Lisp expression in a given environment." alt="" coords="358,107,473,133"/>
<area shape="poly" title=" " alt="" coords="506,121,475,123,473,117,511,119"/>
<area shape="poly" title=" " alt="" coords="440,91,432,88,416,85,400,87,392,92,390,97,394,107,389,106,385,98,388,88,398,82,416,80,434,83,445,91"/>
<area shape="rect" href="group__core__evaluator.html#gac73aee08818a5eb01f0d71ba1291c314" title="Recursively evaluates every element in a list of expressions." alt="" coords="209,161,278,188"/>
<area shape="poly" title=" " alt="" coords="354,140,279,166,277,161,359,137"/>
<area shape="poly" title=" " alt="" coords="271,146,262,142,243,140,226,142,216,147,214,152,219,161,213,161,208,153,212,143,224,137,243,135,264,137,276,146"/>
<area shape="poly" title=" " alt="" coords="504,60,461,55,461,50,509,59"/>
<area shape="poly" title=" " alt="" coords="505,171,435,167,395,159,357,148,308,123,270,94,270,89,311,118,359,143,397,154,436,162,511,170"/>
<area shape="poly" title=" " alt="" coords="510,190,444,210,358,223,312,226,266,224,220,216,176,202,142,183,114,158,77,111,77,106,118,154,145,179,178,198,221,211,266,218,312,220,358,218,443,205,515,188"/>
<area shape="poly" title=" " alt="" coords="508,152,458,137,458,131,513,152"/>
<area shape="poly" title=" " alt="" coords="506,185,474,192,416,195,358,192,279,183,278,178,358,187,416,190,473,187,511,183"/>
</map>
</div>

</div>
</div>
<a id="ga2028290a2a15c13bf821b0c1e22bc1d4" name="ga2028290a2a15c13bf821b0c1e22bc1d4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga2028290a2a15c13bf821b0c1e22bc1d4">&#9670;&#160;</a></span>arena_destroy()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void arena_destroy </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structArena.html">Arena</a> *</td>          <td class="paramname"><span class="paramname"><em>arena</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Destroys the arena and frees all its memory. </p>
<p>Frees the arena structure and its buffer. The arena pointer becomes invalid and must not be used after this call.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">arena</td><td>Pointer to the arena to destroy. Can be NULL (no-op).</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>It is safe to call this with NULL (it becomes a no-op). </dd></dl>

</div>
</div>
<a id="ga4e867a0e03259da5851987e845cb9972" name="ga4e867a0e03259da5851987e845cb9972"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga4e867a0e03259da5851987e845cb9972">&#9670;&#160;</a></span>arena_init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structArena.html">Arena</a> * arena_init </td>
          <td>(</td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>initial_capacity</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initializes an arena with a specified initial capacity. </p>
<p>Allocates the arena structure along with its initial buffer as a single contiguous block. If <span class="tt">initial_capacity</span> is 0, a default size is used. The arena will automatically grow as needed.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">initial_capacity</td><td>Initial size in bytes for the buffer. Use 0 for default (1KB). </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Pointer to the newly allocated arena.</dd></dl>
<dl class="section note"><dt>Note</dt><dd>The arena will grow exponentially (by GROWTH_FACTOR) when it runs out of space, so the initial size doesn't need to be perfect.</dd></dl>
<dl class="section warning"><dt>Warning</dt><dd>Exits the program on allocation failure. </dd></dl>

</div>
</div>
<a id="gaac7cdbd76fd9b528470346b3363052fb" name="gaac7cdbd76fd9b528470346b3363052fb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaac7cdbd76fd9b528470346b3363052fb">&#9670;&#160;</a></span>arena_print_stats()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void arena_print_stats </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structArena.html">Arena</a> *</td>          <td class="paramname"><span class="paramname"><em>arena</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>name</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Prints statistics about the arena's memory usage. </p>
<p>Useful for debugging and profiling memory usage.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">arena</td><td>Pointer to the arena to inspect. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">name</td><td>A descriptive name for the arena (e.g., "Temp" or "Permanent"). </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="gac48c0591afbd71c1fd3ac2c6875c9999" name="gac48c0591afbd71c1fd3ac2c6875c9999"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gac48c0591afbd71c1fd3ac2c6875c9999">&#9670;&#160;</a></span>arena_reset()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void arena_reset </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structArena.html">Arena</a> *</td>          <td class="paramname"><span class="paramname"><em>arena</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Resets the arena, making all its memory available for reuse. </p>
<p>This is an O(1) operation that simply resets the <span class="tt">used</span> counter to 0. The underlying buffer is not deallocated, so subsequent allocations will reuse the same memory.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">arena</td><td>Pointer to the arena to reset.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section warning"><dt>Warning</dt><dd>After calling this function, <b>all pointers</b> previously returned by <span class="tt"><a class="el" href="#ga494c8cea4f0fa116e2559b9dfc080600" title="Allocates a block of memory from the arena.">arena_alloc()</a></span> from this arena become invalid. Using them results in undefined behavior! </dd></dl>

</div>
</div>
<a id="ga80e56a0ed80fb9e01b0fb7604f5687f9" name="ga80e56a0ed80fb9e01b0fb7604f5687f9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga80e56a0ed80fb9e01b0fb7604f5687f9">&#9670;&#160;</a></span>arena_strdup()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char * arena_strdup </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structArena.html">Arena</a> **</td>          <td class="paramname"><span class="paramname"><em>arena_ptr</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>s</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Duplicates a string into the arena. </p>
<p>Allocates space for a copy of the string <span class="tt">s</span> (including null terminator) and copies the string into it.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">arena_ptr</td><td>Pointer to the arena pointer. May be updated if reallocation occurs. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">s</td><td>The null-terminated string to duplicate. Can be NULL. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Pointer to the duplicated string, or NULL if <span class="tt">s</span> was NULL.</dd></dl>
<dl class="section note"><dt>Note</dt><dd>The returned pointer has the same lifetime as other arena allocations. </dd></dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__arena_ga80e56a0ed80fb9e01b0fb7604f5687f9_cgraph.png" border="0" usemap="#agroup__arena_ga80e56a0ed80fb9e01b0fb7604f5687f9_cgraph" loading="lazy" alt=""/></div>
<map name="agroup__arena_ga80e56a0ed80fb9e01b0fb7604f5687f9_cgraph" id="agroup__arena_ga80e56a0ed80fb9e01b0fb7604f5687f9_cgraph">
<area shape="rect" title="Duplicates a string into the arena." alt="" coords="5,5,102,32"/>
<area shape="rect" href="group__arena.html#ga494c8cea4f0fa116e2559b9dfc080600" title="Allocates a block of memory from the arena." alt="" coords="150,5,237,32"/>
<area shape="poly" title=" " alt="" coords="102,16,137,18,131,19,102,21"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__arena_ga80e56a0ed80fb9e01b0fb7604f5687f9_icgraph.png" border="0" usemap="#agroup__arena_ga80e56a0ed80fb9e01b0fb7604f5687f9_icgraph" loading="lazy" alt=""/></div>
<map name="agroup__arena_ga80e56a0ed80fb9e01b0fb7604f5687f9_icgraph" id="agroup__arena_ga80e56a0ed80fb9e01b0fb7604f5687f9_icgraph">
<area shape="rect" title="Duplicates a string into the arena." alt="" coords="662,85,758,112"/>
<area shape="rect" href="group__value__constructors.html#ga3f01b34fda4a498bb58353076297f904" title="Creates a Value of type TYPE_ATOM." alt="" coords="523,85,612,112"/>
<area shape="poly" title=" " alt="" coords="643,99,613,101,613,96,649,98"/>
<area shape="rect" href="group__value__constructors.html#ga4bfa92d1baa0a598b48587524e0ab392" title="Creates a Value of type TYPE_ERROR with a formatted message." alt="" coords="524,148,611,175"/>
<area shape="poly" title=" " alt="" coords="666,118,600,150,599,145,661,119"/>
<area shape="rect" href="group__value__constructors.html#ga86414e13068fdebe957e1444cf3bd45e" title="Creates a Value of type TYPE_STRING." alt="" coords="521,35,614,61"/>
<area shape="poly" title=" " alt="" coords="653,79,607,65,608,59,658,80"/>
<area shape="rect" href="group__parser.html#gab44ed7c4f63e2ecefe687b4c38d436a2" title="Parses the string in current_token_buf into a number, string, or atom Value." alt="" coords="371,35,460,61"/>
<area shape="poly" title=" " alt="" coords="508,80,458,65,458,59,513,80"/>
<area shape="rect" href="group__parser.html#ga34b7e5578bd23df76c6c0e8cde2cce56" title="The main recursive parsing function." alt="" coords="177,48,310,91"/>
<area shape="poly" title=" " alt="" coords="505,94,311,78,311,73,510,92"/>
<area shape="poly" title=" " alt="" coords="353,56,311,64,310,58,358,55"/>
<area shape="poly" title=" " alt="" coords="269,33,260,29,243,27,227,29,218,33,214,39,215,48,210,46,209,38,214,29,226,23,243,21,262,24,275,32"/>
<area shape="rect" href="group__parser.html#ga96e89ce14c76411e95f85b3698efbc1c" title="Top&#45;level function to parse a single complete S&#45;expression from the stream." alt="" coords="5,5,129,32"/>
<area shape="poly" title=" " alt="" coords="159,47,117,35,116,30,164,45"/>
<area shape="rect" href="group__parser.html#ga8a7f8b2d75c03f46abf130c218c4262f" title="Parses a list expression from the token stream." alt="" coords="28,56,106,83"/>
<area shape="poly" title=" " alt="" coords="159,80,106,79,105,74,163,77"/>
<area shape="poly" title=" " alt="" coords="120,58,179,59,174,62,122,64"/>
<area shape="rect" href="group__core__evaluator.html#gac92b6c96045b3975a831d3a5a7be4843" title="Evaluates a single Lisp expression in a given environment." alt="" coords="358,160,473,187"/>
<area shape="poly" title=" " alt="" coords="511,166,474,171,474,166,506,166"/>
<area shape="poly" title=" " alt="" coords="440,144,432,141,416,139,400,141,392,145,390,151,394,161,389,158,385,151,388,142,398,136,416,133,434,136,445,145"/>
<area shape="rect" href="group__core__evaluator.html#gac73aee08818a5eb01f0d71ba1291c314" title="Recursively evaluates every element in a list of expressions." alt="" coords="209,160,278,187"/>
<area shape="poly" title=" " alt="" coords="340,173,279,176,278,171,345,173"/>
<area shape="poly" title=" " alt="" coords="271,144,262,141,243,139,226,141,216,145,214,151,218,161,214,158,208,151,212,142,224,136,243,133,264,136,276,145"/>
<area shape="poly" title=" " alt="" coords="503,48,461,51,461,45,508,48"/>
</map>
</div>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<div id="page-nav" class="page-nav-panel">
<div id="page-nav-resize-handle"></div>
<div id="page-nav-tree">
<div id="page-nav-contents">
</div><!-- page-nav-contents -->
</div><!-- page-nav-tree -->
</div><!-- page-nav -->
</div><!-- container -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.15.0 </li>
  </ul>
</div>
</body>
</html>
