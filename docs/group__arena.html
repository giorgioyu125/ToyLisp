<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.15.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ToyLisp: Arena Allocator</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">ToyLisp<span id="projectnumber">&#160;0.2.0</span>
   </div>
   <div id="projectbrief">A simple lisp interpreter</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.15.0 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search/",'.html');
</script>
<script type="text/javascript">
$(function() { codefold.init(); });
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(function(){initNavTree('group__arena.html','',''); });
</script>
<div id="container">
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="headertitle"><div class="title">Arena Allocator </div></div>
</div><!--header-->
<div class="contents">

<p>Fast region-based memory allocation with automatic growth.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-nested-classes" class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:Arena" id="r_Arena"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structArena.html">Arena</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Represents a memory arena for fast allocation and bulk deallocation.  <a href="structArena.html#details">More...</a><br /></td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-define-members" class="groupheader"><a id="define-members" name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:gab4f6f82fd3600f31ee1807840e1ec5b3" id="r_gab4f6f82fd3600f31ee1807840e1ec5b3"><td class="memItemLeft" align="right" valign="top"><a id="gab4f6f82fd3600f31ee1807840e1ec5b3" name="gab4f6f82fd3600f31ee1807840e1ec5b3"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>GROWTH_FACTOR</b>&#160;&#160;&#160;2</td></tr>
<tr class="memdesc:gab4f6f82fd3600f31ee1807840e1ec5b3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Factor by which the arena grows when it runs out of space. <br /></td></tr>
<tr class="memitem:gaba979d386607d556208cc0e905db89d3" id="r_gaba979d386607d556208cc0e905db89d3"><td class="memItemLeft" align="right" valign="top"><a id="gaba979d386607d556208cc0e905db89d3" name="gaba979d386607d556208cc0e905db89d3"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>DEFAULT_ARENA_CAPACITY</b>&#160;&#160;&#160;1024</td></tr>
<tr class="memdesc:gaba979d386607d556208cc0e905db89d3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Default initial capacity if 0 is passed to <a class="el" href="#ga4e867a0e03259da5851987e845cb9972" title="Initializes an arena with a specified initial capacity.">arena_init()</a>. <br /></td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-func-members" class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ga4e867a0e03259da5851987e845cb9972" id="r_ga4e867a0e03259da5851987e845cb9972"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structArena.html">Arena</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga4e867a0e03259da5851987e845cb9972">arena_init</a> (size_t initial_capacity)</td></tr>
<tr class="memdesc:ga4e867a0e03259da5851987e845cb9972"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initializes an arena with a specified initial capacity.  <br /></td></tr>
<tr class="memitem:ga494c8cea4f0fa116e2559b9dfc080600" id="r_ga494c8cea4f0fa116e2559b9dfc080600"><td class="memItemLeft" align="right" valign="top">void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga494c8cea4f0fa116e2559b9dfc080600">arena_alloc</a> (<a class="el" href="structArena.html">Arena</a> **arena_ptr, size_t size)</td></tr>
<tr class="memdesc:ga494c8cea4f0fa116e2559b9dfc080600"><td class="mdescLeft">&#160;</td><td class="mdescRight">Allocates a block of memory from the arena.  <br /></td></tr>
<tr class="memitem:gac48c0591afbd71c1fd3ac2c6875c9999" id="r_gac48c0591afbd71c1fd3ac2c6875c9999"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#gac48c0591afbd71c1fd3ac2c6875c9999">arena_reset</a> (<a class="el" href="structArena.html">Arena</a> *arena)</td></tr>
<tr class="memdesc:gac48c0591afbd71c1fd3ac2c6875c9999"><td class="mdescLeft">&#160;</td><td class="mdescRight">Resets the arena, making all its memory available for reuse.  <br /></td></tr>
<tr class="memitem:ga2028290a2a15c13bf821b0c1e22bc1d4" id="r_ga2028290a2a15c13bf821b0c1e22bc1d4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga2028290a2a15c13bf821b0c1e22bc1d4">arena_destroy</a> (<a class="el" href="structArena.html">Arena</a> *arena)</td></tr>
<tr class="memdesc:ga2028290a2a15c13bf821b0c1e22bc1d4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Destroys the arena and frees all its memory.  <br /></td></tr>
<tr class="memitem:ga80e56a0ed80fb9e01b0fb7604f5687f9" id="r_ga80e56a0ed80fb9e01b0fb7604f5687f9"><td class="memItemLeft" align="right" valign="top">char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga80e56a0ed80fb9e01b0fb7604f5687f9">arena_strdup</a> (<a class="el" href="structArena.html">Arena</a> **arena_ptr, const char *s)</td></tr>
<tr class="memdesc:ga80e56a0ed80fb9e01b0fb7604f5687f9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Duplicates a string into the arena.  <br /></td></tr>
<tr class="memitem:gaac7cdbd76fd9b528470346b3363052fb" id="r_gaac7cdbd76fd9b528470346b3363052fb"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#gaac7cdbd76fd9b528470346b3363052fb">arena_print_stats</a> (const <a class="el" href="structArena.html">Arena</a> *arena, const char *name)</td></tr>
<tr class="memdesc:gaac7cdbd76fd9b528470346b3363052fb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Prints statistics about the arena's memory usage.  <br /></td></tr>
</table>
<a name="details" id="details"></a><h2 id="header-details" class="groupheader">Detailed Description</h2>
<p>Fast region-based memory allocation with automatic growth. </p>
<p>The arena allocator provides a simple and efficient way to manage memory for objects with similar lifetimes. It allocates from a contiguous buffer and can reset all allocations at once without individual frees.</p>
<p><b>Key features:</b></p><ul>
<li>Amortized O(1) allocation through exponential growth</li>
<li>O(1) bulk deallocation via <span class="tt"><a class="el" href="#gac48c0591afbd71c1fd3ac2c6875c9999" title="Resets the arena, making all its memory available for reuse.">arena_reset()</a></span></li>
<li>Sequential memory layout (cache-friendly)</li>
<li>No per-allocation overhead</li>
<li>No fragmentation</li>
</ul>
<p><b>Typical usage pattern:</b> </p><div class="fragment"><div class="line"><a class="code hl_struct" href="structArena.html">Arena</a>* temp_arena = <a class="code hl_function" href="#ga4e867a0e03259da5851987e845cb9972">arena_init</a>(4096);  <span class="comment">// Start with 4KB</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// Allocate many objects...</span></div>
<div class="line"><span class="keywordtype">char</span>* str = <a class="code hl_function" href="#ga80e56a0ed80fb9e01b0fb7604f5687f9">arena_strdup</a>(&amp;temp_arena, <span class="stringliteral">&quot;hello&quot;</span>);</div>
<div class="line"><span class="keywordtype">int</span>* array = <a class="code hl_function" href="#ga494c8cea4f0fa116e2559b9dfc080600">arena_alloc</a>(&amp;temp_arena, 100 * <span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Free everything at once</span></div>
<div class="line"><a class="code hl_function" href="#gac48c0591afbd71c1fd3ac2c6875c9999">arena_reset</a>(temp_arena);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Cleanup</span></div>
<div class="line"><a class="code hl_function" href="#ga2028290a2a15c13bf821b0c1e22bc1d4">arena_destroy</a>(temp_arena);</div>
<div class="ttc" id="agroup__arena_html_ga2028290a2a15c13bf821b0c1e22bc1d4"><div class="ttname"><a href="#ga2028290a2a15c13bf821b0c1e22bc1d4">arena_destroy</a></div><div class="ttdeci">void arena_destroy(Arena *arena)</div><div class="ttdoc">Destroys the arena and frees all its memory.</div><div class="ttdef"><b>Definition</b> arena.c:72</div></div>
<div class="ttc" id="agroup__arena_html_ga494c8cea4f0fa116e2559b9dfc080600"><div class="ttname"><a href="#ga494c8cea4f0fa116e2559b9dfc080600">arena_alloc</a></div><div class="ttdeci">void * arena_alloc(Arena **arena_ptr, size_t size)</div><div class="ttdoc">Allocates a block of memory from the arena.</div><div class="ttdef"><b>Definition</b> arena.c:31</div></div>
<div class="ttc" id="agroup__arena_html_ga4e867a0e03259da5851987e845cb9972"><div class="ttname"><a href="#ga4e867a0e03259da5851987e845cb9972">arena_init</a></div><div class="ttdeci">Arena * arena_init(size_t initial_capacity)</div><div class="ttdoc">Initializes an arena with a specified initial capacity.</div><div class="ttdef"><b>Definition</b> arena.c:13</div></div>
<div class="ttc" id="agroup__arena_html_ga80e56a0ed80fb9e01b0fb7604f5687f9"><div class="ttname"><a href="#ga80e56a0ed80fb9e01b0fb7604f5687f9">arena_strdup</a></div><div class="ttdeci">char * arena_strdup(Arena **arena_ptr, const char *s)</div><div class="ttdoc">Duplicates a string into the arena.</div><div class="ttdef"><b>Definition</b> arena.c:76</div></div>
<div class="ttc" id="agroup__arena_html_gac48c0591afbd71c1fd3ac2c6875c9999"><div class="ttname"><a href="#gac48c0591afbd71c1fd3ac2c6875c9999">arena_reset</a></div><div class="ttdeci">void arena_reset(Arena *arena)</div><div class="ttdoc">Resets the arena, making all its memory available for reuse.</div><div class="ttdef"><b>Definition</b> arena.c:68</div></div>
<div class="ttc" id="astructArena_html"><div class="ttname"><a href="structArena.html">Arena</a></div><div class="ttdoc">Represents a memory arena for fast allocation and bulk deallocation.</div><div class="ttdef"><b>Definition</b> arena.h:74</div></div>
</div><!-- fragment --><dl class="section warning"><dt>Warning</dt><dd>After <span class="tt"><a class="el" href="#gac48c0591afbd71c1fd3ac2c6875c9999" title="Resets the arena, making all its memory available for reuse.">arena_reset()</a></span>, all pointers previously returned by <span class="tt"><a class="el" href="#ga494c8cea4f0fa116e2559b9dfc080600" title="Allocates a block of memory from the arena.">arena_alloc()</a></span> become invalid. Do not use them!</dd>
<dd>
After <span class="tt"><a class="el" href="#ga2028290a2a15c13bf821b0c1e22bc1d4" title="Destroys the arena and frees all its memory.">arena_destroy()</a></span>, the arena pointer itself is invalidated.</dd>
<dd>
Since the arena uses realloc for growth, you must pass the arena by pointer-to-pointer to <span class="tt"><a class="el" href="#ga494c8cea4f0fa116e2559b9dfc080600" title="Allocates a block of memory from the arena.">arena_alloc()</a></span> and <span class="tt"><a class="el" href="#ga80e56a0ed80fb9e01b0fb7604f5687f9" title="Duplicates a string into the arena.">arena_strdup()</a></span>, as the arena's address may change during reallocation. </dd></dl>
<a name="doc-func-members" id="doc-func-members"></a><h2 id="header-doc-func-members" class="groupheader">Function Documentation</h2>
<a id="ga494c8cea4f0fa116e2559b9dfc080600" name="ga494c8cea4f0fa116e2559b9dfc080600"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga494c8cea4f0fa116e2559b9dfc080600">&#9670;&#160;</a></span>arena_alloc()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void * arena_alloc </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structArena.html">Arena</a> **</td>          <td class="paramname"><span class="paramname"><em>arena_ptr</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>size</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Allocates a block of memory from the arena. </p>
<p>Returns a pointer to a memory block of at least <span class="tt">size</span> bytes. The returned pointer is aligned to 8 bytes. If the arena doesn't have enough space, it automatically grows by GROWTH_FACTOR (doubling its size).</p>
<p>The growth strategy ensures amortized O(1) allocation time:</p><ul>
<li>Starting with capacity C, after n doublings we have capacity C*2^n</li>
<li>Total bytes allocated across all reallocations: C + 2C + 4C + ... + C*2^n = C*(2^(n+1) - 1)</li>
<li>This is O(final_capacity), so the amortized cost per byte is O(1)</li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">arena_ptr</td><td>Pointer to the arena pointer. The arena pointer may be updated if reallocation occurs. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">size</td><td>Number of bytes to allocate. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Pointer to the allocated memory (8-byte aligned) within the arena's buffer.</dd></dl>
<dl class="section warning"><dt>Warning</dt><dd>You must pass the address of your arena pointer (<span class="tt">&amp;<a class="el" href="group__arena.html" title="Fast region-based memory allocation with automatic growth.">Arena Allocator</a></span>), not the pointer itself, because realloc may move the arena in memory.</dd>
<dd>
The returned pointer becomes invalid after <span class="tt"><a class="el" href="#gac48c0591afbd71c1fd3ac2c6875c9999" title="Resets the arena, making all its memory available for reuse.">arena_reset()</a></span> or <span class="tt"><a class="el" href="#ga2028290a2a15c13bf821b0c1e22bc1d4" title="Destroys the arena and frees all its memory.">arena_destroy()</a></span> is called on the arena.</dd>
<dd>
Exits the program if reallocation fails. </dd></dl>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__arena_ga494c8cea4f0fa116e2559b9dfc080600_icgraph.png" border="0" usemap="#agroup__arena_ga494c8cea4f0fa116e2559b9dfc080600_icgraph" loading="lazy" alt=""/></div>
<map name="agroup__arena_ga494c8cea4f0fa116e2559b9dfc080600_icgraph" id="agroup__arena_ga494c8cea4f0fa116e2559b9dfc080600_icgraph">
<area shape="rect" title="Allocates a block of memory from the arena." alt="" coords="834,220,921,247"/>
<area shape="rect" href="group__arena.html#ga80e56a0ed80fb9e01b0fb7604f5687f9" title="Duplicates a string into the arena." alt="" coords="676,81,772,108"/>
<area shape="poly" title=" " alt="" coords="853,210,784,141,745,111,748,106,788,137,857,207"/>
<area shape="rect" href="group__value__constructors.html#ga56b1cea30d98236c9dbbecef01b814fe" title="Creates a Value of type TYPE_CLOSURE." alt="" coords="673,195,775,221"/>
<area shape="poly" title=" " alt="" coords="818,226,775,219,776,214,819,221"/>
<area shape="rect" href="group__value__constructors.html#ga172f8b614c16d7f29a55701f9e3f535d" title="Creates and allocates a raw Closure struct pointer." alt="" coords="662,245,786,272"/>
<area shape="poly" title=" " alt="" coords="819,246,787,251,786,246,818,240"/>
<area shape="rect" href="group__value__constructors.html#gabe632b0fee2d6973f5cea25bfd28def0" title="Creates a Value of type TYPE_CONS (a list pair)." alt="" coords="523,157,612,184"/>
<area shape="poly" title=" " alt="" coords="844,214,816,198,785,185,740,175,694,171,612,170,612,165,694,165,741,170,787,180,819,193,847,209"/>
<area shape="rect" href="group__value__constructors.html#ga7e2c2e70f225b9dd96cff95b0166a76b" title="Creates a Value of type TYPE_MACRO." alt="" coords="676,296,772,323"/>
<area shape="poly" title=" " alt="" coords="842,257,787,286,761,298,759,293,785,282,839,252"/>
<area shape="rect" href="group__value__constructors.html#ga0d057406365078f8dcb5cbbc9dc04619" title="Creates and allocates a raw Macro struct pointer." alt="" coords="665,347,783,373"/>
<area shape="poly" title=" " alt="" coords="861,261,829,299,788,337,767,348,764,344,784,333,825,296,856,258"/>
<area shape="rect" href="group__value__constructors.html#ga3f01b34fda4a498bb58353076297f904" title="Creates a Value of type TYPE_ATOM." alt="" coords="523,5,612,32"/>
<area shape="poly" title=" " alt="" coords="680,76,596,35,598,30,682,72"/>
<area shape="rect" href="group__value__constructors.html#ga4bfa92d1baa0a598b48587524e0ab392" title="Creates a Value of type TYPE_ERROR with a formatted message." alt="" coords="524,107,611,133"/>
<area shape="poly" title=" " alt="" coords="661,108,612,116,611,110,660,102"/>
<area shape="rect" href="group__value__constructors.html#ga86414e13068fdebe957e1444cf3bd45e" title="Creates a Value of type TYPE_STRING." alt="" coords="521,56,614,83"/>
<area shape="poly" title=" " alt="" coords="660,87,614,79,615,74,661,82"/>
<area shape="rect" href="group__parser.html#gab44ed7c4f63e2ecefe687b4c38d436a2" title="Parses the string in current_token_buf into a number, string, or atom Value." alt="" coords="371,32,460,59"/>
<area shape="poly" title=" " alt="" coords="508,32,461,40,460,35,507,27"/>
<area shape="rect" href="group__parser.html#ga34b7e5578bd23df76c6c0e8cde2cce56" title="The main recursive parsing function." alt="" coords="177,48,310,91"/>
<area shape="poly" title=" " alt="" coords="507,15,436,14,359,23,320,34,285,50,283,45,319,29,357,17,435,9,507,10"/>
<area shape="poly" title=" " alt="" coords="356,56,311,63,310,57,355,51"/>
<area shape="poly" title=" " alt="" coords="271,35,260,29,243,27,227,29,218,33,214,39,215,47,210,48,209,38,214,29,226,23,243,21,262,24,273,30"/>
<area shape="rect" href="group__parser.html#ga96e89ce14c76411e95f85b3698efbc1c" title="Top&#45;level function to parse a single complete S&#45;expression from the stream." alt="" coords="5,31,129,57"/>
<area shape="poly" title=" " alt="" coords="161,60,129,55,129,50,162,55"/>
<area shape="rect" href="group__parser.html#ga8a7f8b2d75c03f46abf130c218c4262f" title="Parses a list expression from the token stream." alt="" coords="28,81,106,108"/>
<area shape="poly" title=" " alt="" coords="162,93,106,99,106,94,161,87"/>
<area shape="poly" title=" " alt="" coords="120,76,176,68,177,73,121,81"/>
<area shape="rect" href="group__core__evaluator.html#gac92b6c96045b3975a831d3a5a7be4843" title="Evaluates a single Lisp expression in a given environment." alt="" coords="358,107,473,133"/>
<area shape="poly" title=" " alt="" coords="509,123,474,123,474,117,509,117"/>
<area shape="poly" title=" " alt="" coords="441,94,432,88,416,85,400,87,392,92,390,97,394,105,389,107,385,98,388,88,398,82,416,80,434,83,444,89"/>
<area shape="rect" href="group__core__evaluator.html#gac73aee08818a5eb01f0d71ba1291c314" title="Recursively evaluates every element in a list of expressions." alt="" coords="209,161,278,188"/>
<area shape="poly" title=" " alt="" coords="357,141,279,166,277,161,356,136"/>
<area shape="poly" title=" " alt="" coords="272,148,262,142,243,140,226,142,216,147,214,152,218,160,214,162,208,153,212,143,224,137,243,135,264,137,275,144"/>
<area shape="poly" title=" " alt="" coords="506,62,461,55,461,50,507,57"/>
<area shape="poly" title=" " alt="" coords="508,173,435,167,395,159,357,148,308,123,268,93,271,89,311,118,359,143,397,154,436,162,508,168"/>
<area shape="poly" title=" " alt="" coords="514,192,444,210,358,223,312,226,266,224,220,216,176,202,142,183,114,158,75,110,79,107,118,154,145,179,178,198,221,211,266,218,312,220,358,218,443,205,512,187"/>
<area shape="poly" title=" " alt="" coords="510,154,457,136,459,131,512,149"/>
<area shape="poly" title=" " alt="" coords="509,187,474,192,416,195,358,192,278,183,279,178,358,187,416,190,473,187,508,182"/>
</map>
</div>

</div>
</div>
<a id="ga2028290a2a15c13bf821b0c1e22bc1d4" name="ga2028290a2a15c13bf821b0c1e22bc1d4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga2028290a2a15c13bf821b0c1e22bc1d4">&#9670;&#160;</a></span>arena_destroy()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void arena_destroy </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structArena.html">Arena</a> *</td>          <td class="paramname"><span class="paramname"><em>arena</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Destroys the arena and frees all its memory. </p>
<p>Frees the arena structure and its buffer. The arena pointer becomes invalid and must not be used after this call.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">arena</td><td>Pointer to the arena to destroy. Can be NULL (no-op).</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>It is safe to call this with NULL (it becomes a no-op). </dd></dl>

</div>
</div>
<a id="ga4e867a0e03259da5851987e845cb9972" name="ga4e867a0e03259da5851987e845cb9972"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga4e867a0e03259da5851987e845cb9972">&#9670;&#160;</a></span>arena_init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structArena.html">Arena</a> * arena_init </td>
          <td>(</td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>initial_capacity</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initializes an arena with a specified initial capacity. </p>
<p>Allocates the arena structure along with its initial buffer as a single contiguous block. If <span class="tt">initial_capacity</span> is 0, a default size is used. The arena will automatically grow as needed.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">initial_capacity</td><td>Initial size in bytes for the buffer. Use 0 for default (1KB). </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Pointer to the newly allocated arena.</dd></dl>
<dl class="section note"><dt>Note</dt><dd>The arena will grow exponentially (by GROWTH_FACTOR) when it runs out of space, so the initial size doesn't need to be perfect.</dd></dl>
<dl class="section warning"><dt>Warning</dt><dd>Exits the program on allocation failure. </dd></dl>

</div>
</div>
<a id="gaac7cdbd76fd9b528470346b3363052fb" name="gaac7cdbd76fd9b528470346b3363052fb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaac7cdbd76fd9b528470346b3363052fb">&#9670;&#160;</a></span>arena_print_stats()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void arena_print_stats </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structArena.html">Arena</a> *</td>          <td class="paramname"><span class="paramname"><em>arena</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>name</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Prints statistics about the arena's memory usage. </p>
<p>Useful for debugging and profiling memory usage.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">arena</td><td>Pointer to the arena to inspect. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">name</td><td>A descriptive name for the arena (e.g., "Temp" or "Permanent"). </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="gac48c0591afbd71c1fd3ac2c6875c9999" name="gac48c0591afbd71c1fd3ac2c6875c9999"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gac48c0591afbd71c1fd3ac2c6875c9999">&#9670;&#160;</a></span>arena_reset()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void arena_reset </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structArena.html">Arena</a> *</td>          <td class="paramname"><span class="paramname"><em>arena</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Resets the arena, making all its memory available for reuse. </p>
<p>This is an O(1) operation that simply resets the <span class="tt">used</span> counter to 0. The underlying buffer is not deallocated, so subsequent allocations will reuse the same memory.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">arena</td><td>Pointer to the arena to reset.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section warning"><dt>Warning</dt><dd>After calling this function, <b>all pointers</b> previously returned by <span class="tt"><a class="el" href="#ga494c8cea4f0fa116e2559b9dfc080600" title="Allocates a block of memory from the arena.">arena_alloc()</a></span> from this arena become invalid. Using them results in undefined behavior! </dd></dl>

</div>
</div>
<a id="ga80e56a0ed80fb9e01b0fb7604f5687f9" name="ga80e56a0ed80fb9e01b0fb7604f5687f9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga80e56a0ed80fb9e01b0fb7604f5687f9">&#9670;&#160;</a></span>arena_strdup()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char * arena_strdup </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structArena.html">Arena</a> **</td>          <td class="paramname"><span class="paramname"><em>arena_ptr</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>s</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Duplicates a string into the arena. </p>
<p>Allocates space for a copy of the string <span class="tt">s</span> (including null terminator) and copies the string into it.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">arena_ptr</td><td>Pointer to the arena pointer. May be updated if reallocation occurs. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">s</td><td>The null-terminated string to duplicate. Can be NULL. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Pointer to the duplicated string, or NULL if <span class="tt">s</span> was NULL.</dd></dl>
<dl class="section note"><dt>Note</dt><dd>The returned pointer has the same lifetime as other arena allocations. </dd></dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__arena_ga80e56a0ed80fb9e01b0fb7604f5687f9_cgraph.png" border="0" usemap="#agroup__arena_ga80e56a0ed80fb9e01b0fb7604f5687f9_cgraph" loading="lazy" alt=""/></div>
<map name="agroup__arena_ga80e56a0ed80fb9e01b0fb7604f5687f9_cgraph" id="agroup__arena_ga80e56a0ed80fb9e01b0fb7604f5687f9_cgraph">
<area shape="rect" title="Duplicates a string into the arena." alt="" coords="5,5,102,32"/>
<area shape="rect" href="group__arena.html#ga494c8cea4f0fa116e2559b9dfc080600" title="Allocates a block of memory from the arena." alt="" coords="150,5,237,32"/>
<area shape="poly" title=" " alt="" coords="102,16,134,16,134,21,102,21"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__arena_ga80e56a0ed80fb9e01b0fb7604f5687f9_icgraph.png" border="0" usemap="#agroup__arena_ga80e56a0ed80fb9e01b0fb7604f5687f9_icgraph" loading="lazy" alt=""/></div>
<map name="agroup__arena_ga80e56a0ed80fb9e01b0fb7604f5687f9_icgraph" id="agroup__arena_ga80e56a0ed80fb9e01b0fb7604f5687f9_icgraph">
<area shape="rect" title="Duplicates a string into the arena." alt="" coords="662,85,758,112"/>
<area shape="rect" href="group__value__constructors.html#ga3f01b34fda4a498bb58353076297f904" title="Creates a Value of type TYPE_ATOM." alt="" coords="523,85,612,112"/>
<area shape="poly" title=" " alt="" coords="646,101,613,101,613,96,646,96"/>
<area shape="rect" href="group__value__constructors.html#ga4bfa92d1baa0a598b48587524e0ab392" title="Creates a Value of type TYPE_ERROR with a formatted message." alt="" coords="524,148,611,175"/>
<area shape="poly" title=" " alt="" coords="665,121,601,150,599,145,663,116"/>
<area shape="rect" href="group__value__constructors.html#ga86414e13068fdebe957e1444cf3bd45e" title="Creates a Value of type TYPE_STRING." alt="" coords="521,35,614,61"/>
<area shape="poly" title=" " alt="" coords="655,82,606,64,608,59,657,77"/>
<area shape="rect" href="group__parser.html#gab44ed7c4f63e2ecefe687b4c38d436a2" title="Parses the string in current_token_buf into a number, string, or atom Value." alt="" coords="371,35,460,61"/>
<area shape="poly" title=" " alt="" coords="510,82,457,64,459,59,512,77"/>
<area shape="rect" href="group__parser.html#ga34b7e5578bd23df76c6c0e8cde2cce56" title="The main recursive parsing function." alt="" coords="177,48,310,91"/>
<area shape="poly" title=" " alt="" coords="507,96,310,78,311,73,507,91"/>
<area shape="poly" title=" " alt="" coords="356,58,311,64,310,58,355,53"/>
<area shape="poly" title=" " alt="" coords="271,35,260,29,243,27,227,29,218,33,214,39,215,47,210,48,209,38,214,29,226,23,243,21,262,24,273,30"/>
<area shape="rect" href="group__parser.html#ga96e89ce14c76411e95f85b3698efbc1c" title="Top&#45;level function to parse a single complete S&#45;expression from the stream." alt="" coords="5,5,129,32"/>
<area shape="poly" title=" " alt="" coords="161,48,115,35,117,30,162,43"/>
<area shape="rect" href="group__parser.html#ga8a7f8b2d75c03f46abf130c218c4262f" title="Parses a list expression from the token stream." alt="" coords="28,56,106,83"/>
<area shape="poly" title=" " alt="" coords="161,81,106,80,106,74,161,76"/>
<area shape="poly" title=" " alt="" coords="121,58,176,58,176,63,121,64"/>
<area shape="rect" href="group__core__evaluator.html#gac92b6c96045b3975a831d3a5a7be4843" title="Evaluates a single Lisp expression in a given environment." alt="" coords="358,160,473,187"/>
<area shape="poly" title=" " alt="" coords="509,169,474,171,474,166,509,163"/>
<area shape="poly" title=" " alt="" coords="441,147,432,141,416,139,400,141,392,145,390,151,394,158,389,161,385,151,388,142,398,136,416,133,434,136,444,143"/>
<area shape="rect" href="group__core__evaluator.html#gac73aee08818a5eb01f0d71ba1291c314" title="Recursively evaluates every element in a list of expressions." alt="" coords="209,160,278,187"/>
<area shape="poly" title=" " alt="" coords="342,176,278,176,278,171,342,171"/>
<area shape="poly" title=" " alt="" coords="272,147,262,141,243,139,226,141,216,145,214,151,218,158,214,161,208,151,212,142,224,136,243,133,264,136,275,142"/>
<area shape="poly" title=" " alt="" coords="506,51,461,51,461,45,506,45"/>
</map>
</div>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<div id="page-nav" class="page-nav-panel">
<div id="page-nav-resize-handle"></div>
<div id="page-nav-tree">
<div id="page-nav-contents">
</div><!-- page-nav-contents -->
</div><!-- page-nav-tree -->
</div><!-- page-nav -->
</div><!-- container -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.15.0 </li>
  </ul>
</div>
</body>
</html>
